<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-learn/learn-xcm">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Cross-Consensus Message Format (XCM) · Selendra Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wiki.selendra.org/docs/learn-xcm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cross-Consensus Message Format (XCM) · Selendra Wiki"><meta data-rh="true" name="description" content="Learn about the messaging format at the forefront of interoperability."><meta data-rh="true" property="og:description" content="Learn about the messaging format at the forefront of interoperability."><meta data-rh="true" name="keywords" content="cross-consensus,XCM,XCMP,interoperability,communication"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wiki.selendra.org/docs/learn-xcm"><link data-rh="true" rel="alternate" href="https://wiki.selendra.org/docs/learn-xcm" hreflang="en"><link data-rh="true" rel="alternate" href="https://wiki.selendra.org/docs/learn-xcm" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BEUYRRAUZN-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Selendra Wiki" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js" onload="addBackToTop()" defer="defer"></script>
<script src="https://apisa.web3.foundation/latest.js" async defer="defer"></script>
<script src="../js/custom.js"></script>
<script src="../js/clipboard.min.js"></script>
<script src="../js/copycode.js"></script><link rel="stylesheet" href="/assets/css/styles.34720e60.css">
<link rel="preload" href="/assets/js/runtime~main.4c5c9155.js" as="script">
<link rel="preload" href="/assets/js/main.d87a59c7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Selendra_Logo_Horizontal.png" alt="Selendra Wiki" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Selendra_Logo_Horizontal.png" alt="Selendra Wiki" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/getting-started">Get Started</a><a class="navbar__item navbar__link" href="/docs/learn-launch">Learn</a><a class="navbar__item navbar__link" href="/docs/build-index">Build</a><a class="navbar__item navbar__link" href="/docs/maintain-index">Maintain </a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a class="navbar__item navbar__link" href="/docs/contributing">Contribute</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/learn-xcm" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="https://crowdin.com/project/selendra-wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help us translate</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/getting-started">General</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/learn-accounts">Learn</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/learn-accounts">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/learn-account-advanced">Advanced</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-account-advanced">Accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-availability">Availability and Validity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/learn-xcm">Cross-Consensus Message Format (XCM)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-phragmen">NPoS Election Algorithms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-proxies">Proxy Accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-randomness">Randomness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-simple-payouts">Simple Payouts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-staking-advanced">Advanced Staking Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-staking-miner">Staking Miner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-wasm">WebAssembly (Wasm)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/learn-cryptography">Cryptography</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/learn-parachains">Paraobjects</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/learn-comparisons">Selendra Comparisons</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-launch">Selendra Launch Phases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-video-tutorials">Video Tutorials</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/build-index">Build</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/maintain-index">Maintain</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Learn</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Advanced</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cross-Consensus Message Format (XCM)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cross-Consensus Message Format (XCM)</h1></header><p>Cross-Consensus Message Format(XCM) aims to be a language to communicate ideas between consensus
systems. One of Selendra&#x27;s promises is that of interoperability, and XCM is the vehicle through
which it will deliver this promise. Simply, it is a standard that allows protocol developers to
define the data and origins which their chains can send and receive from. Out of the box, it comes
with a VM that allows for customization of execution as well as the following properties:</p><ol><li><strong>Asynchronous</strong>: XCM messages in no way assume that the sender will be blocking on its
completion.</li><li><strong>Absolute</strong>: XCM messages are guaranteed to be delivered and interpreted accurately, in order
and in a timely fashion.</li><li><strong>Asymmetric</strong>: XCM messages out of the box do not have results that let the sender know that the
message was received. Any results must be separately communicated to the sender with an
additional message.</li><li><strong>Agnostic</strong>: XCM makes no assumptions about the nature of the Consensus Systems between which
the messages are being passed.</li></ol><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>XCM is a work-in-progress. XCM v2 is deployed on Selendra and v3 is currently in development. Learn
more about XCM v3 and its new features in the <a href="#resources">resources</a> section.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-format-not-a-protocol">A Format, Not a Protocol<a class="hash-link" href="#a-format-not-a-protocol" title="Direct link to heading">​</a></h2><p>What started as an approach to <em>cross-chain communication</em>, has evolved into a format for
<a href="https://polkadot.network/cross-chain-communication" target="_blank" rel="noopener noreferrer"><strong>Cross-Consensus Communication</strong></a> that is not
only conducted between chains, but also between smart contracts, pallets, bridges.</p><p>XCM cannot actually send messages between systems. It is a format for how message transfer should be
performed, similar to how RESTful services use REST as an architectural style of development.</p><p>Similar to UDP, out of the box XCM is a &quot;fire and forget&quot; model, unless there is a seperate XCM
message designed to be a response message which can be sent from the recipient to the sender. Any
kind of error handling should also be done on the recipient side.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>XCM is not designed in a way where every system supporting the format is expected to be able to
interpret any possible XCM message. Practically speaking, one can imagine that some messages will
not have reasonable interpretations under some systems or will be intentionally unsupported.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-use-cases">Example Use-Cases<a class="hash-link" href="#example-use-cases" title="Direct link to heading">​</a></h3><ul><li>Request for specific operations to occur on the recipient system such as governance voting.</li><li>Enables single use-case chains e.g. <a href="/docs/learn-Cardamom.md">Cardamom/e</a> as asset parachains</li><li>Optionally include payment of fees on a target network for requested operation.</li><li>Provide methods for various asset transfer models:<ul><li><strong>Remote Transfers</strong>: control an account on a remote chain, allowing the local chain to have an
address on the remote chain for receiving funds and to eventually transfer those funds it
controls into other accounts on that remote chain.</li><li><strong>Asset Teleportation</strong>: movement of an asset happens by destroying it on one side and creating
a clone on the other side.</li><li><strong>Reserve Asset Transfer</strong>: there may be two chains that want to nominate a third chain, where
one includes a native asset that can be used as a reserve for that asset. Then, the derivative
form of the asset on each of those chains would be fully backed, allowing the derivative asset
to be exchanged for the underlying asset on the reserve chain backing it.</li></ul></li></ul><p>Let&#x27;s review two of these example asset transfer use cases: <strong>Asset Teleportation</strong> and <strong>Reserve
Asset Transfer</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="asset-teleportation">Asset Teleportation<a class="hash-link" href="#asset-teleportation" title="Direct link to heading">​</a></h3><p>An asset teleport operation from a single source to a single destination.</p><p><img loading="lazy" alt="Diagram of the usage flow while teleporting assets" src="/assets/images/xcm-asset-teleportation-fa5ec3787ee0c9bed184c11b95444385.png" width="659" height="304" class="img_ev3q"></p><ol><li><a href="https://github.com/paritytech/xcm-format#initiateteleport" target="_blank" rel="noopener noreferrer">InitiateTeleport</a></li></ol><p>The source gathers the assets to be teleported from the sending account and takes them out of the
circulating supply, taking note of the total amount of assets that was taken out.</p><ol start="2"><li><a href="https://github.com/paritytech/xcm-format#receiveteleportedasset" target="_blank" rel="noopener noreferrer">ReceiveTeleportedAsset</a></li></ol><p>The source then creates an XCM instruction called <code>ReceiveTeleportedAssets</code> and puts the amount of
assets taken out of circulation and the receiving account as parameters to this instruction. It then
sends this instruction over to the destination, where it gets processed and new assets gets put back
into circulating supply accordingly.</p><ol start="3"><li><a href="https://github.com/paritytech/xcm-format#depositasset" target="_blank" rel="noopener noreferrer">DepositAsset</a></li></ol><p>The destination then deposits the assets to the receiving account of the asset.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reserve-asset-transfer">Reserve Asset Transfer<a class="hash-link" href="#reserve-asset-transfer" title="Direct link to heading">​</a></h3><p>When consensus systems do not have a established layer of trust over which they can transfer assets,
they can opt for a trusted 3rd entity to store the assets.</p><p><img loading="lazy" src="/assets/images/xcm-reserve-asset-transfer-daa1c383e969a1b782c40109f70dcfde.png" width="656" height="482" class="img_ev3q"></p><ol><li><a href="https://github.com/paritytech/xcm-format#initiatereservewithdraw" target="_blank" rel="noopener noreferrer">InitiateReserveWithdraw</a></li></ol><p>The source gathers the derivative assets to be transferred from the sending account and burns them,
taking note of the amount of derivatives that were burned.</p><ol start="2"><li><a href="https://github.com/paritytech/xcm-format#withdrawasset" target="_blank" rel="noopener noreferrer">WithdrawAsset</a></li></ol><p>The source sends a WithdrawAsset instruction to the reserve, instructing the reserve to withdraw
assets equivalent to the amount of derivatives burned from the source&#x27;s sovereign account.</p><ol start="3"><li><a href="https://github.com/paritytech/xcm-format#depositreserveasset" target="_blank" rel="noopener noreferrer">DepositReserveAsset</a></li></ol><p>The reserve deposits the assets withdrawn from the previous step to the destination&#x27;s sovereign
account, taking note of the amount of assets deposited.</p><ol start="4"><li><a href="https://github.com/paritytech/xcm-format#reserveassetdeposited" target="_blank" rel="noopener noreferrer">ReserveAssetDeposited</a></li></ol><p>The reserve creates a ReserveAssetDeposited instruction with the amount of assets deposited to the
destination&#x27;s sovereign account, and sends this instruction onwards to the destination. The
destination receives the instruction and processes it, minting the derivative assets as a result of
the process.</p><ol start="5"><li><a href="https://github.com/paritytech/xcm-format#depositasset" target="_blank" rel="noopener noreferrer">DepositAsset</a></li></ol><p>The destination deposits the derivative assets minted to the receiving account.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xcm-tech-stack">XCM Tech Stack<a class="hash-link" href="#xcm-tech-stack" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="xcm tech stack" src="/assets/images/cross-consensus-tech-stack-e9c1b2ab8b6f6f3f9a78b3a412af0698.png" width="1204" height="1316" class="img_ev3q"></p><p>XCM can be used to express the meaning of the messages over each of these three communication
channels.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xcvm-cross-consensus-virtual-machine">XCVM (Cross-Consensus Virtual Machine)<a class="hash-link" href="#xcvm-cross-consensus-virtual-machine" title="Direct link to heading">​</a></h2><p>At the core of XCM lies the Cross-Consensus Virtual Machine (XCVM). A “message” in XCM is an XCVM
program. The XCVM is a state machine, state is kept track in Registers.</p><p>It’s an ultra-high level non-Turing-complete computer whose instructions are designed to be roughly
at the same level as transactions. Messages are one or more XCM instructions. The program executes
until it either runs to the end or hits an error, at which point it finishes up and halts. An XCM
executor following the XCVM specification is provided by Parity, and it can be extended or
customized, or even ignored altogether and users can create their own construct that follows the
XCVM spec.</p><p>A <em>message</em> in XCM is simply just a programme that runs on the <code>XCVM</code>: in other words, one or more
XCM instructions. To learn more about the XCVM and the XCM Format, see the latest
<a href="https://medium.com/polkadot-network/xcm-the-cross-consensus-message-format-3b77b1373392" target="_blank" rel="noopener noreferrer">blog post</a>
by Dr. Gavin Wood.</p><p>XCM instructions might change a register, they might change the state of the consensus system or
both.</p><p>One example of such an instruction would be <code>TransferAsset</code> which is used to transfer an asset to
some other address on the remote system. It needs to be told which asset(s) to transfer and to
whom/where the asset is to be transferred.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enum Instruction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TransferAsset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assets: MultiAssets,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        beneficiary: MultiLocation,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /* snip */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A <code>MultiAsset</code> is a general identifier for an asset. It may represent both fungible and non-fungible
assets, and in the case of a fungible asset, it represents some defined amount of the asset.</p><p>A <code>MultiLocation</code> is a relative identifier, meaning that it can only be used to define the relative
path between two locations, and cannot generally be used to refer to a location universally. Much
like a relative file-system path will first begin with any &quot;../&quot; components used to ascend into to
the containing directory, followed by the directory names into which to descend, a <code>MultiLocation</code>
has two main parts to it: the number of times to ascend into the outer consensus from the local and
then an interior location within that outer consensus.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cross-consensus-protocols-xcmp-vmp-hrmp">Cross-Consensus Protocols (XCMP, VMP, HRMP)<a class="hash-link" href="#cross-consensus-protocols-xcmp-vmp-hrmp" title="Direct link to heading">​</a></h2><p>With the XCM format established, common patterns for protocols of these messages are needed.
Selendra implements two message passing protocols for acting on XCM messages between its constituent
parachains.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xcmp-cross-chain-message-passing">XCMP (Cross-Chain Message Passing)<a class="hash-link" href="#xcmp-cross-chain-message-passing" title="Direct link to heading">​</a></h3><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>XCMP is currently under development and most cross-chain message passing uses HRMP channels for the
time being.</p></div></div><p>XCM is related to XCMP in the same way that REST is related to RESTful.</p><p><em>Cross-Chain Message Passing</em> secure message passing between parachains. There are two variants:
<em>Direct</em> and <em>Relayed</em>.</p><ul><li>With <em>Direct</em>, message data goes direct between parachains and is O(1) on the side of the
Relay-chain and is very scalable.</li><li>With <em>Relayed</em>, message data is passed via the Relay-chain, and piggy-backs over VMP. It is much
less scalable, and parathreads in particular may not receive messages due to excessive queue
growth.</li></ul><p>Cross-chain transactions are resolved using a simple queuing mechanism based around a Merkle tree to
ensure fidelity. It is the task of the Relay Chain validators to move transactions on the output
queue of one parachain into the input queue of the destination parachain. However, only the
associated metadata is stored as a hash in the Relay Chain storage.</p><p>The input and output queue are sometimes referred to in the Selendra codebase and associated
documentation as <code>ingress</code> and <code>egress</code> messages, respectively.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vmp-vertical-message-passing">VMP (Vertical Message Passing)<a class="hash-link" href="#vmp-vertical-message-passing" title="Direct link to heading">​</a></h3><p><em>Vertical Message Passing</em> message passing between the Relay-chain itself and a parachain. Message
data in both cases exists on the Relay-chain. This includes:</p><ul><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ump-upward-message-passing">UMP (Upward Message Passing)<a class="hash-link" href="#ump-upward-message-passing" title="Direct link to heading">​</a></h4><p><em>Upward Message Passing</em> message passing from a parachain to the Relay-chain.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dmp-downward-message-passing">DMP (Downward Message Passing)<a class="hash-link" href="#dmp-downward-message-passing" title="Direct link to heading">​</a></h4><p><em>Downward Message Passing</em> message passing from the Relay-chain to a parachain.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hrmp-xcmp-lite">HRMP (XCMP-Lite)<a class="hash-link" href="#hrmp-xcmp-lite" title="Direct link to heading">​</a></h3><p>While XCMP is still being implemented, a stop-gap protocol (see definition below) known as
<strong>Horizontal Relay-routed Message Passing (HRMP)</strong> exists in its place. HRMP has the same interface
and functionality as XCMP but is much more demanding on resources since it stores all messages in
the Relay Chain storage. When XCMP has been implemented, HRMP is planned to be deprecated and phased
out in favor of it.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>A stop-gap protocol is a temporary substitute for the functionality that is not fully complete.
While XCMP proper is still in development, HRMP is a working replacement.</p></div></div><p>A tutorial on how to open an HRMP channel on a parachain can be found
<a href="/docs/build-hrmp-channels">here</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xcmp-design">XCMP Design<a class="hash-link" href="#xcmp-design" title="Direct link to heading">​</a></h4><ul><li>Cross-chain messages will <em>not</em> be delivered to the Relay Chain.</li><li>Cross-chain messages will be constrained to a maximum size specified in bytes.</li><li>Parachains are allowed to block messages from other parachains, in which case the dispatching
parachain would be aware of this block.</li><li>Collator nodes are responsible for routing messages between chains.</li><li>Collators produce a list of <code>egress</code> messages and will receive the <code>ingress</code> messages from other
parachains.</li><li>On each block, parachains are expected to route messages from some subset of all other parachains.</li><li>When a collator produces a new block to hand off to a validator, it will collect the latest
ingress queue information and process it.</li><li>Validators will check the proof that the new candidate for the next parachain block includes the
processing of the expected ingress messages to that parachain.</li></ul><p>XCMP queues must be initiated by first opening a channel between two parachains. The channel is
identified by both the sender and recipient parachains, meaning that it&#x27;s a one-way channel. A pair
of parachains can have at most establish two channels between them, one for sending messages to the
other chain and another for receiving messages. The channel will require a deposit in SEL to be
opened, which will get returned when the channel is closed.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cross-consensus-message-format-xcm">Cross-Consensus Message Format (XCM)<a class="hash-link" href="#cross-consensus-message-format-xcm" title="Direct link to heading">​</a></h4><p>For an updated and complete description of the cross-consensus message format please see the
<a href="https://github.com/paritytech/xcm-format" target="_blank" rel="noopener noreferrer">xcm-format repository on GitHub</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-anatomy-of-an-xcmp-interaction">The Anatomy of an XCMP Interaction<a class="hash-link" href="#the-anatomy-of-an-xcmp-interaction" title="Direct link to heading">​</a></h4><p>A smart contract that exists on parachain <code>A</code> will route a message to parachain <code>B</code> in which another
smart contract is called that makes a transfer of some assets within that chain.</p><p>Charlie executes the smart contract on parachain <code>A</code>, which initiates a new cross-chain message for
the destination of a smart contract on parachain <code>B</code>.</p><p>The collator node of parachain <code>A</code> will place this new cross-chain message into its outbound
messages queue, along with a <code>destination</code> and a <code>timestamp</code>.</p><p>The collator node of parachain <code>B</code> routinely pings all other collator nodes asking for new messages
(filtering by the <code>destination</code> field). When the collator of parachain <code>B</code> makes its next ping, it
will see this new message on parachain <code>A</code> and add it into its own inbound queue for processing into
the next block.</p><p>Validators for parachain <code>A</code> will also read the outbound queue and know the message. Validators for
parachain <code>B</code> will do the same. This is so that they will be able to verify the message transmission
happened.</p><p>When the collator of parachain <code>B</code> is building the next block in its chain, it will process the new
message in its inbound queue as well as any other messages it may have found/received.</p><p>During processing, the message will execute the smart contract on parachain <code>B</code> and complete the
asset transfer as intended.</p><p>The collator now hands this block to the validator, which itself will verify that this message was
processed. If the message was processed and all other aspects of the block are valid, the validator
will include this block for parachain <code>B</code> into the Relay Chain.</p><p>Check out our animated video below that explores how XCMP works.</p><video controls="" name="XCMP Animated Video" width="560" height="315" src="https://storage.googleapis.com/w3f-tech-ed-contents/XCMP.mp4"> Sorry, your browser doesn&#x27;t support embedded videos. </video><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wip">WIP<a class="hash-link" href="#wip" title="Direct link to heading">​</a></h3></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/selendra/selendra-wiki/edit/master/docs/learn/learn-xcm.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-11-18T07:51:00.000Z">Nov 18, 2022</time></b> by <b>hangsiahong</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/learn-availability"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Availability and Validity</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/learn-phragmen"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">NPoS Election Algorithms</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-format-not-a-protocol" class="table-of-contents__link toc-highlight">A Format, Not a Protocol</a><ul><li><a href="#example-use-cases" class="table-of-contents__link toc-highlight">Example Use-Cases</a></li><li><a href="#asset-teleportation" class="table-of-contents__link toc-highlight">Asset Teleportation</a></li><li><a href="#reserve-asset-transfer" class="table-of-contents__link toc-highlight">Reserve Asset Transfer</a></li><li><a href="#xcm-tech-stack" class="table-of-contents__link toc-highlight">XCM Tech Stack</a></li></ul></li><li><a href="#xcvm-cross-consensus-virtual-machine" class="table-of-contents__link toc-highlight">XCVM (Cross-Consensus Virtual Machine)</a></li><li><a href="#cross-consensus-protocols-xcmp-vmp-hrmp" class="table-of-contents__link toc-highlight">Cross-Consensus Protocols (XCMP, VMP, HRMP)</a><ul><li><a href="#xcmp-cross-chain-message-passing" class="table-of-contents__link toc-highlight">XCMP (Cross-Chain Message Passing)</a></li><li><a href="#vmp-vertical-message-passing" class="table-of-contents__link toc-highlight">VMP (Vertical Message Passing)</a></li><li><a href="#hrmp-xcmp-lite" class="table-of-contents__link toc-highlight">HRMP (XCMP-Lite)</a></li></ul></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a><ul><li><a href="#wip" class="table-of-contents__link toc-highlight">WIP</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="nav-footer spacer-y-4 pb-4" id="footer"><div class="container-custom container"><div class="justify-content-start row"><div class="mb-3 mb-md-5 col-lg-3 col-md-4 col-6"><h5 class="text-white text-heading font-weight-medium">General</h5><ul class="list-unstyled"><li class="py-0 py-md-1"><a href="https://selendra.com/about" class="text-white" target="_blank" rel="noopener noreferrer">About</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/launch-roadmap" class="text-white" target="_blank" rel="noopener noreferrer">Roadmap</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/build" class="text-white" target="_blank" rel="noopener noreferrer">Build</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/staking/" class="text-white" target="_blank" rel="noopener noreferrer">Staking</a></li>content=<!-- -->Careers<!-- -->href=&quot;https://selendra.com/jobs&quot; /&gt;<li class="py-0 py-md-1"><a href="https://selendra.com/faq" class="text-white" target="_blank" rel="noopener noreferrer">FAQ</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/contact" class="text-white" target="_blank" rel="noopener noreferrer">Contact</a></li></ul></div><div class="mb-3 mb-md-5 col-lg-3 col-md-4 col-6"><h5 class="text-white text-heading font-weight-medium">Technology</h5><ul class="list-unstyled"><li class="py-0 py-md-1"><a href="https://selendra.com/technology" class="text-white" target="_blank" rel="noopener noreferrer">Technology</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/cross-chain-communication" class="text-white" target="_blank" rel="noopener noreferrer">XCM</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/parachains" class="text-white" target="_blank" rel="noopener noreferrer">Parachains</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/sel-token" class="text-white" target="_blank" rel="noopener noreferrer">Token</a></li><li class="py-0 py-md-1"><a href="https://telemetry.selendra.io/" class="text-white" target="_blank" rel="noopener noreferrer">Telemetry</a></li><li class="py-0 py-md-1"><a href="https://www.parity.io/substrate" class="text-white" target="_blank" rel="noopener noreferrer">Substrate</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/SelendraPaper.pdf" class="text-white" target="_blank" rel="noopener noreferrer">Whitepaper</a></li><li class="py-0 py-md-1"><a href="https://selendra.org/Selendra-lightpaper.pdf" class="text-white" target="_blank" rel="noopener noreferrer">Lightpaper</a></li></ul></div><div class="mb-3 mb-md-5 col-lg-3 col-md-4 col-6"><h5 class="text-white text-heading font-weight-medium">Community</h5><ul class="list-unstyled"><li class="py-0 py-md-1"><a href="https://selendra.org/community" class="text-white" target="_blank" rel="noopener noreferrer">Community</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/academy" class="text-white" target="_blank" rel="noopener noreferrer">Academy</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/auctions" class="text-white" target="_blank" rel="noopener noreferrer">Auctions</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/treasury/" class="text-white" target="_blank" rel="noopener noreferrer">Treasury</a></li><li class="py-0 py-md-1"><a href="http://wiki.selendra.org/en/latest/" class="text-white" target="_blank" rel="noopener noreferrer">Documentation</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/blog" class="text-white" target="_blank" rel="noopener noreferrer">Blog</a></li><li class="py-0 py-md-1"><a href="https://selendra.com/brand-assets" class="text-white" target="_blank" rel="noopener noreferrer">Brand Assets</a></li><li class="py-0 py-md-1"><a href="https://app.element.io/#/room/!FdCojkeGzZLSEoiecf:web3.foundation?via=matrix.parity.io&amp;via=matrix.org&amp;via=web3.foundation" class="text-white" target="_blank" rel="noopener noreferrer">Element Chat</a></li><li class="py-0 py-md-1"><a href="https://medium.com/selendra" class="text-white" target="_blank" rel="noopener noreferrer">Medium</a></li></ul></div><div class="px-lg-0 col-lg-3 col-md-12"><ul class="list-social-links mb-4 mt-5 mt-lg-0"><li class="text-white mr-2 mr-lg-0 mr-xl-2 mb-2"><a href="https://twitter.com/Selendra" target="_blank" rel="noopener noreferrer"><i class="socicon-twitter"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2 mb-2"><a href="https://www.reddit.com/r/selendra" target="_blank" rel="noopener noreferrer"><i class="socicon-reddit"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2 mb-2"><a href="https://github.com/selendra/selendra" target="_blank" rel="noopener noreferrer"><i class="socicon-github"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2 mb-2"><a href="https://www.youtube.com/channel/UCWO6SVOPiR6CFBrHRLD2DDA" target="_blank" rel="noopener noreferrer"><i class="socicon-youtube"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2 mb-2"><a href="https://sel.li/discord" target="_blank" rel="noopener noreferrer"><i class="socicon-discord"></i></a></li></ul><p class="d-block text-white">Subscribe to the newsletter to hear about Selendra updates and events.</p><button type="button" class="btn btn-primary"><a href="https://info.selendra.org/subscribe" target="_blank" style="color:white">Subscribe</a></button></div></div><div class="footer-legal align-items-end mt-5 pt-4 row"><div class="mb-2 mb-lg-0 col-lg-2"><a class="navbar-brand" href="https://selendra.com/" target="_blank" rel="noopener noreferrer"><bold>Selendra Network</bold></a></div><div class="col-lg-10"><ul class="list-unstyled d-flex flex-wrap list-pipe-separator"><li><a href="https://selendra.com/disclaimer" class="text-white text-small" target="_blank" rel="noopener noreferrer">Disclaimer</a></li><li><a href="https://selendra.com/privacy" class="text-white text-small" target="_blank" rel="noopener noreferrer">Privacy</a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.4c5c9155.js"></script>
<script src="/assets/js/main.d87a59c7.js"></script>
</body>
</html>